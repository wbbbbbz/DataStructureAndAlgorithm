# 第 8 章 最小生成树

- 带权图(Weighted Graph)
  - 每一个边可能带值
- 邻接矩阵很好修改。true,false 改为权值，没有边改为 0
- 邻接表每一个节点需要存储两个数据，节点和权重
  - 可以封装成 Edge 类，{节点索引, 权重}
- 为了保证可以使用统一的接口，所以邻接矩阵也可以使用 Edge 类

  - 没有边的地方就保存 null

- 最小生成树问题 Minimum Span Tree

  - 对于一棵完全联通的带权图来说，可否找到一棵这个图所属的生成树
  - v-1 条边连接 v 个节点。
  - 这棵生成树连接了所有节点，并且所有边的权值相加是最小的！
  - 电缆布线设计，网络设计，电路设计
  - 针对带权无向图，连通图
    - 不连通图可以通过求出连通分量，然后每一个连通图构建一棵生成树，组成森林

- 切分定理 Cut Property

  - 把图中结点分为两部分，成为一个切分(Cut)
  - 如果一个边的两个端点，属于切分(Cut)不同的两边，这个边称为横切边(Crossing Edge)
  - 给定*任意*切分，横切边中权值最小的边必然属于最小生成树
    - 因为是连通图，所以切分一定有横切边
    - 假设有一条横切边是最小生成树的边，但是不是最小的边
    - 此时可以在最小生成树中添加最小的边，一定形成了一个环
    - 环一定包含最小的边和原来的最小生成树的边
    - 因为最小生成树不能有环，所以可以删掉原来那条边，保留权值更小的边
  - 从一个点开始一点点扩散，进行切分，求边

- Lazy Prim 普利姆算法

  - 从 0 节点，把所有的边放入最小堆中，拿出最小堆中的最短边就好
  - 最小边 1 确定之后，把该边的另一个顶点加入当前切分，寻找新的最小边
  - 不断加入新的顶点的时候，会出现最小堆中可能会有边不是横切边了
    - Lazy Prim 是先无视，拿出最小边的时候再检查是不是横切边
  - 所有边都会进入 priority queue，所以循环执行 E 次
    - extractMin 是 log(E)
    - visit 是 O(E)或者 O(V^2)
    - insert 是 log(E)
  - 综上 O(ElogE)

- 可以优化到 O(ElogV)

  - Lazy Prim 中的问题
    - 所有边都要进最小堆，但是切分该边的时候很多边已经不是横切边了
    - 只关注最小的横切边
  - 需要一种数据结构存储和每个节点相连的最小横切边
    - 不断改变切分的时候只要不断更新和每个节点相连的横切边
  - 要满足取出最小值，并且能更新
  - IndexMinHeap
  - 开节点空间，每一个索引存储与对应节点相连的最小横切边
  - 选择一个起始节点，该节点不用存储信息

- Kruskal 算法
  - 所有最小的边组成起来的就是生成树？
  - 先进行所有边的排序(ElogE)
  - 先加入一下最小生成树，看一下会不会形成环
    - 只要不形成环，直接加入
    - 因为一定会有一个切分能使该边成为横切边
  - 复杂的是判断环(ElogV)
    - 采用并查集就好！
    - 加入最小树，就是对两个端点进行 union 操作
    - 如果两个端点已经是同一个根了那就是环了！
  - 比优化过的Prim慢，但是实现简单

- 如果横切边有相等的边
  - 每次选择一个边，所以图存在多个最小生成树

- 课后学习
  - 所有的最小生成树
  - Vyssotsky's Algorithm
    - 将边逐渐地添加到生成树中，一旦形成环，删除环中权值最大的边
      - 但是没有优秀的数据结构可以进行辅助
  
